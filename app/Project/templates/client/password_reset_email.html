{% autoescape off %}
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Password Reset - {{ site_name }}</title>
    </head>
    <body style="margin: 0;
                 padding: 0;
                 font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                 background-color: #f8fafc">
      <table width="100%"
             cellpadding="0"
             cellspacing="0"
             style="background-color: #f8fafc">
        <tr>
          <td align="center" style="padding: 40px 20px;">
            <table width="600"
                   cellpadding="0"
                   cellspacing="0"
                   style="background-color: #ffffff;
                          border-radius: 12px;
                          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1)">
              <!-- Header -->
              <tr>
                <td style="background-color: #667eea;
                           padding: 32px;
                           text-align: center;
                           border-radius: 12px 12px 0 0">
                  <h1 style="color: #ffffff; margin: 0; font-size: 24px; font-weight: bold">{{ site_name }}</h1>
                  <p style="color: #ffffff; margin: 8px 0 0 0; font-size: 14px;">You've Been Invited!</p>
                </td>
              </tr>
              <!-- Body -->
              <tr>
                <td style="padding: 40px 32px;">
                  <h2 style="color: #1f2937;
                             margin: 0 0 16px 0;
                             font-size: 20px;
                             font-weight: 600">Welcome {{ user.first_name|default:user.email }}!</h2>
                  <p style="color: #6b7280;
                            margin: 0 0 24px 0;
                            font-size: 16px;
                            line-height: 1.6">
                    You have been invited to join <strong>{{ client_name }}</strong> as a client user on {{ site_name }}. To get started, please set up your password by clicking the button below:
                  </p>
                  <!-- Project Details -->
                  {% if project_name %}
                    <div style="background-color: #eff6ff;
                                border-left: 4px solid #3b82f6;
                                padding: 16px;
                                margin: 24px 0;
                                border-radius: 6px">
                      <p style="color: #1e40af;
                                margin: 0 0 8px 0;
                                font-size: 14px;
                                font-weight: 600">üìã Project Information</p>
                      <p style="color: #1e40af; margin: 0; font-size: 14px;">
                        <strong>Project:</strong> {{ project_name }}
                      </p>
                      {% if project_description %}
                        <p style="color: #1e40af; margin: 8px 0 0 0; font-size: 14px;">
                          <strong>Description:</strong> {{ project_description }}
                        </p>
                      {% endif %}
                      <p style="color: #1e40af; margin: 8px 0 0 0; font-size: 14px;">
                        <strong>Client:</strong> {{ client_name }}
                      </p>
                    </div>
                  {% endif %}
                  <!-- CTA Button -->
                  <div style="text-align: center; margin: 32px 0;">
                    <table cellpadding="0" cellspacing="0" style="margin: 0 auto;">
                      <tr>
                        <td style="background-color: #667eea;
                                   padding: 16px 32px;
                                   border-radius: 8px;
                                   text-align: center">
                          <a href="{{ protocol }}://{{ domain }}{% url 'password_reset_confirm' uidb64=uid token=token %}"
                             style="color: #ffffff;
                                    text-decoration: none;
                                    font-weight: 600;
                                    font-size: 16px;
                                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                                    display: inline-block;
                                    line-height: 1.5">Set My Password</a>
                        </td>
                      </tr>
                    </table>
                  </div>
                  <!-- Alternative Link -->
                  <p style="color: #6b7280;
                            margin: 0 0 16px 0;
                            font-size: 14px;
                            text-align: center">Or copy and paste this link into your browser:</p>
                  <p style="color: #667eea;
                            margin: 0 0 24px 0;
                            font-size: 12px;
                            word-break: break-all;
                            text-align: center;
                            background-color: #f3f4f6;
                            padding: 12px;
                            border-radius: 6px">
                    {{ protocol }}://{{ domain }}{% url 'password_reset_confirm' uidb64=uid token=token %}
                  </p>
                  <!-- Security Info -->
                  <div style="background-color: #fef3c7;
                              border-left: 4px solid #f59e0b;
                              padding: 16px;
                              margin: 24px 0;
                              border-radius: 6px">
                    <p style="color: #92400e; margin: 0; font-size: 14px; font-weight: 600;">‚ö†Ô∏è Security Notice</p>
                    <p style="color: #92400e; margin: 8px 0 0 0; font-size: 14px;">
                      This link will expire in {{ expiry_hours|default:"24" }} hours for security purposes.
                    </p>
                  </div>
                  <!-- Account Info -->
                  <div style="background-color: #f3f4f6;
                              padding: 16px;
                              border-radius: 6px;
                              margin: 24px 0">
                    <p style="color: #374151;
                              margin: 0 0 8px 0;
                              font-size: 14px;
                              font-weight: 600">Account Details:</p>
                    <p style="color: #6b7280; margin: 0; font-size: 14px;">
                      <strong>Email:</strong> {{ user.email }}
                    </p>
                  </div>
                  <!-- Footer -->
                  <p style="color: #6b7280; margin: 0; font-size: 14px; line-height: 1.6;">
                    If you believe you received this invitation in error, please contact the project administrator or ignore this email.
                  </p>
                </td>
              </tr>
              <!-- Footer -->
              <tr>
                <td style="background-color: #f9fafb;
                           padding: 32px;
                           text-align: center;
                           border-radius: 0 0 12px 12px">
                  <p style="color: #9ca3af; margin: 0; font-size: 14px;">
                    Thanks for using {{ site_name }}!
                    <br>
                    <a href="{{ protocol }}://{{ domain }}"
                       style="color: #667eea;
                              text-decoration: none">{{ protocol }}://{{ domain }}</a>
                  </p>
                  <p style="color: #9ca3af; margin: 16px 0 0 0; font-size: 12px;">
                    ¬© {% now "Y" %} {{ site_name }}. All rights reserved.
                  </p>
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </body>
  </html>
{% endautoescape %}
